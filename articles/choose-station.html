<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="clifro">
<title>Choosing a *clifro* Station • clifro</title>
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://docs.ropensci.org/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Choosing a *clifro* Station">
<meta property="og:description" content="clifro">
<meta property="og:image" content="https://docs.ropensci.org/clifro/logo.png">
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Matomo --><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css">
<script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript>
<!-- End Matomo Code -->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../index.html">clifro</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">3.2-5.9003</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="nav-link" href="../articles/clifro.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/cfStation.html">Working with *clifro* Stations</a>
    <a class="dropdown-item" href="../articles/choose-datatype.html">Choosing a *clifro* Datatype</a>
    <a class="dropdown-item" href="../articles/choose-station.html">Choosing a *clifro* Station</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ropensci/clifro/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Choosing a *clifro* Station</h1>
                        <h4 data-toc-skip class="author">Blake Seers</h4>
            
            <h4 data-toc-skip class="date">2024-03-03</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/clifro/blob/HEAD/vignettes/choose-station.Rmd" class="external-link"><code>vignettes/choose-station.Rmd</code></a></small>
      <div class="d-none name"><code>choose-station.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Choosing <code>clifro</code> stations is made easy with the single <code>cf_find_station</code> function. This function is all that is required to find <code>clifro</code> stations. This function is equivalent to conducting the same search on the <a href="https://cliflo.niwa.co.nz/pls/niwp/wstn.get_stn_html" class="external-link">find stations</a> page when conducting a query online at CliFlo, except without some of the errors and bugs. This means that the searches and the types of searches possible are exactly the same however, <code>clifro</code> extends functionality to exploring the spatial nature of stations via KML files, or plotting directly in R. This is the main advantage in searching for stations using <code>clifro</code> as locating suitable stations on a map is generally the preferred search tool.</p>
<p>There are four possible types of searches:</p>
<ul>
<li>A search based on pattern matching the station name</li>
<li>A search based on pattern matching the network ID</li>
<li>A search based on region</li>
<li>A search based on the vicinity of a given location</li>
</ul>
<p>For each of these searches either all, open or closed stations may be returned and these searches also may only return stations where given datatypes are available. The primary goal in searching for stations is to find the unique station agent number required to create a <code>cfStation</code> object. This vignette details the various search options in <code>clifro</code> and ways to find these requisite agent numbers, primarily by way of example.</p>
</div>
<div class="section level2">
<h2 id="ignoring-datatypes">Ignoring datatypes<a class="anchor" aria-label="anchor" href="#ignoring-datatypes"></a>
</h2>
<p>The following examples detail how to use the <code>cf_find_station</code> search function ignoring any datatypes.</p>
<div class="section level3">
<h3 id="station-name-search">Station name search<a class="anchor" aria-label="anchor" href="#station-name-search"></a>
</h3>
<p>Both of these searches use pattern matching to find the appropriate stations. The station name search is useful for searching stations in certain towns or suburbs or maybe even streets and parks. The network ID is a number that is assigned to the stations which makes this search useful to look up stations where these are known.</p>
<p>These searches are used when part or all of the station name or network ID is known. For example, consider we are looking for open stations located in Takaka, at the southeastern end of Golden Bay at the northern end of the South Island, New Zealand. The default for the <code>cf_find_station</code> function is to search <em>open</em> station names matching the string.</p>
<p>At the time of writing this, CliFlo ignores the status argument in the name and network ID search whereas <code>clifro</code> does not. Searching open stations with the station name matching “takaka” on CliFlo will return these stations.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Equivalent to searching for status = "open" on CliFro</span></span>
<span><span class="co"># Note the search string is not case sensitive</span></span>
<span><span class="fu"><a href="../reference/cf_find_station.html">cf_find_station</a></span><span class="op">(</span><span class="st">"takaka"</span>, status <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                      name network agent      start        end  open distance</span></span>
<span><span class="co">## 1)   Takaka, Kotinga Road  F02882  3788 1970-08-01 2020-08-18  TRUE       NA</span></span>
<span><span class="co">## 2)  Riwaka At Takaka Hill  O12090 44046 1980-01-10 2020-08-18  TRUE       NA</span></span>
<span><span class="co">## 3)          Takaka Pohara  F02884  3790 1986-07-01 2020-08-18  TRUE       NA</span></span>
<span><span class="co">## 4)     Takaka At Harwoods  F15292 44050 1988-01-25 2020-08-18  TRUE       NA</span></span>
<span><span class="co">## 5)      Takaka At Kotinga  F15291 44051 1992-04-24 2020-08-18  TRUE       NA</span></span>
<span><span class="co">## 6)        Takaka @ Canaan  F0299A 44072 1994-02-01 2020-08-18  TRUE       NA</span></span>
<span><span class="co">## 7)         Upper Takaka 2  F12083 11519 1995-07-12 2020-08-18  TRUE       NA</span></span>
<span><span class="co">## 8)             Takaka Ews  F02885 23849 2002-04-30 2020-08-18  TRUE       NA</span></span>
<span><span class="co">## 9)       Takaka Aero Raws  O00957 41196 2015-08-12 2020-08-18  TRUE       NA</span></span>
<span><span class="co">## 10)     Takaka, Kotinga 2  F02883  3789 1985-11-30 2012-07-01 FALSE       NA</span></span>
<span><span class="co">## 11)          Upper Takaka  F12082  7316 1991-10-31 1992-10-31 FALSE       NA</span></span>
<span><span class="co">## 12)    Takaka,Patons Rock  F02772  3779 1969-10-01 1975-01-01 FALSE       NA</span></span>
<span><span class="co">## 13)      Takaka,Kotinga 1  F02971  3794 1961-12-01 1971-08-01 FALSE       NA</span></span>
<span><span class="co">## 14)           Takaka Aero  F02871  3785 1936-11-01 1970-04-01 FALSE       NA</span></span>
<span><span class="co">## 15)           Takaka Hill  F12081  3833 1947-09-01 1959-11-01 FALSE       NA</span></span>
<span><span class="co">## 16)          Takaka,Bu Bu  F02872  3786 1933-04-01 1945-11-30 FALSE       NA</span></span>
<span><span class="co">## 17)                Takaka  F02881  3787 1904-01-01 1927-10-01 FALSE       NA</span></span>
<span><span class="co">##           lat      lon</span></span>
<span><span class="co">## 1)  -40.87200 172.8090</span></span>
<span><span class="co">## 2)  -41.03192 172.8444</span></span>
<span><span class="co">## 3)  -40.84500 172.8670</span></span>
<span><span class="co">## 4)  -41.03094 172.7980</span></span>
<span><span class="co">## 5)  -40.87068 172.8080</span></span>
<span><span class="co">## 6)  -40.93987 172.9082</span></span>
<span><span class="co">## 7)  -41.01516 172.8258</span></span>
<span><span class="co">## 8)  -40.86364 172.8057</span></span>
<span><span class="co">## 9)  -40.81531 172.7765</span></span>
<span><span class="co">## 10) -40.88200 172.8010</span></span>
<span><span class="co">## 11) -41.05100 172.8330</span></span>
<span><span class="co">## 12) -40.78900 172.7570</span></span>
<span><span class="co">## 13) -40.90000 172.7750</span></span>
<span><span class="co">## 14) -40.81600 172.7720</span></span>
<span><span class="co">## 15) -41.01700 172.8670</span></span>
<span><span class="co">## 16) -40.85000 172.7330</span></span>
<span><span class="co">## 17) -40.81700 172.8000</span></span></code></pre>
<p>This shows that 8 of these 17 stations are closed. The search in <code>clifro</code> does not ignore the station status.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/cf_find_station.html">cf_find_station</a></span><span class="op">(</span><span class="st">"takaka"</span>, status <span class="op">=</span> <span class="st">"open"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                     name network agent      start        end open distance</span></span>
<span><span class="co">## 1)  Takaka, Kotinga Road  F02882  3788 1970-08-01 2020-08-18 TRUE       NA</span></span>
<span><span class="co">## 2) Riwaka At Takaka Hill  O12090 44046 1980-01-10 2020-08-18 TRUE       NA</span></span>
<span><span class="co">## 3)         Takaka Pohara  F02884  3790 1986-07-01 2020-08-18 TRUE       NA</span></span>
<span><span class="co">## 4)    Takaka At Harwoods  F15292 44050 1988-01-25 2020-08-18 TRUE       NA</span></span>
<span><span class="co">## 5)     Takaka At Kotinga  F15291 44051 1992-04-24 2020-08-18 TRUE       NA</span></span>
<span><span class="co">## 6)       Takaka @ Canaan  F0299A 44072 1994-02-01 2020-08-18 TRUE       NA</span></span>
<span><span class="co">## 7)        Upper Takaka 2  F12083 11519 1995-07-12 2020-08-18 TRUE       NA</span></span>
<span><span class="co">## 8)            Takaka Ews  F02885 23849 2002-04-30 2020-08-18 TRUE       NA</span></span>
<span><span class="co">## 9)      Takaka Aero Raws  O00957 41196 2015-08-12 2020-08-18 TRUE       NA</span></span>
<span><span class="co">##          lat      lon</span></span>
<span><span class="co">## 1) -40.87200 172.8090</span></span>
<span><span class="co">## 2) -41.03192 172.8444</span></span>
<span><span class="co">## 3) -40.84500 172.8670</span></span>
<span><span class="co">## 4) -41.03094 172.7980</span></span>
<span><span class="co">## 5) -40.87068 172.8080</span></span>
<span><span class="co">## 6) -40.93987 172.9082</span></span>
<span><span class="co">## 7) -41.01516 172.8258</span></span>
<span><span class="co">## 8) -40.86364 172.8057</span></span>
<span><span class="co">## 9) -40.81531 172.7765</span></span></code></pre>
<p>Stations are considered open in <code>clifro</code> if the final date returned from the search is within four weeks of the current date. This gives the user a better idea on the stations that are currently collecting data.</p>
</div>
<div class="section level3">
<h3 id="station-network-id-search">Station network ID search<a class="anchor" aria-label="anchor" href="#station-network-id-search"></a>
</h3>
<p>The same can be done for searching stations using network ID although <code>search = "network"</code> needs to be added to the function call. Assume we knew that the only stations we were interested in were the open stations whose network ID’s match <code>F028</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/cf_find_station.html">cf_find_station</a></span><span class="op">(</span><span class="st">"f028"</span>, search <span class="op">=</span> <span class="st">"network"</span>, status <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                           name network agent      start        end  open</span></span>
<span><span class="co">## 1)        Takaka, Kotinga Road  F02882  3788 1970-08-01 2020-08-18  TRUE</span></span>
<span><span class="co">## 2)               Takaka Pohara  F02884  3790 1986-07-01 2020-08-18  TRUE</span></span>
<span><span class="co">## 3)                  Takaka Ews  F02885 23849 2002-04-30 2020-08-18  TRUE</span></span>
<span><span class="co">## 4)  Aorere At Salisbury Bridge  F02854 44020 2011-07-26 2020-08-18  TRUE</span></span>
<span><span class="co">## 5)           Takaka, Kotinga 2  F02883  3789 1985-11-30 2012-07-01 FALSE</span></span>
<span><span class="co">## 6)            Nelson,Mckay Hut  F02821  3780 1983-04-01 1993-08-16 FALSE</span></span>
<span><span class="co">## 7)               Gouland Downs  F02831  3781 1984-10-31 1993-08-16 FALSE</span></span>
<span><span class="co">## 8)       Golden Bay,Table Hl I  F02852  3783 1977-06-01 1991-11-23 FALSE</span></span>
<span><span class="co">## 9)       Golden Bay,Table Hl 2  F02853  3784 1977-06-01 1991-11-23 FALSE</span></span>
<span><span class="co">## 10)                   Tarakohe  F02891  3791 1932-05-01 1989-01-01 FALSE</span></span>
<span><span class="co">## 11)                Takaka Aero  F02871  3785 1936-11-01 1970-04-01 FALSE</span></span>
<span><span class="co">## 12)                  Totaranui  F02892  3792 1957-01-01 1960-08-31 FALSE</span></span>
<span><span class="co">## 13)               Takaka,Bu Bu  F02872  3786 1933-04-01 1945-11-30 FALSE</span></span>
<span><span class="co">## 14)                     Takaka  F02881  3787 1904-01-01 1927-10-01 FALSE</span></span>
<span><span class="co">## 15)              Quartz Ranges  F02851  3782 1901-01-01 1902-08-31 FALSE</span></span>
<span><span class="co">##     distance       lat      lon</span></span>
<span><span class="co">## 1)        NA -40.87200 172.8090</span></span>
<span><span class="co">## 2)        NA -40.84500 172.8670</span></span>
<span><span class="co">## 3)        NA -40.86364 172.8057</span></span>
<span><span class="co">## 4)        NA -40.80236 172.5333</span></span>
<span><span class="co">## 5)        NA -40.88200 172.8010</span></span>
<span><span class="co">## 6)        NA -40.89000 172.2130</span></span>
<span><span class="co">## 7)        NA -40.89200 172.3510</span></span>
<span><span class="co">## 8)        NA -40.80700 172.5560</span></span>
<span><span class="co">## 9)        NA -40.80700 172.5560</span></span>
<span><span class="co">## 10)       NA -40.82500 172.8980</span></span>
<span><span class="co">## 11)       NA -40.81600 172.7720</span></span>
<span><span class="co">## 12)       NA -40.82300 173.0020</span></span>
<span><span class="co">## 13)       NA -40.85000 172.7330</span></span>
<span><span class="co">## 14)       NA -40.81700 172.8000</span></span>
<span><span class="co">## 15)       NA -40.86700 172.5170</span></span></code></pre>
<p>Notice that the resulting dataframes in all of these searches are first ordered by the date they last received data, and then by the date they opened, to return the longest-running open stations first and the most historic, closed stations last.</p>
</div>
<div class="section level3">
<h3 id="return-all-stations-within-a-region">Return all stations within a region<a class="anchor" aria-label="anchor" href="#return-all-stations-within-a-region"></a>
</h3>
<p>This broad search returns all, open or closed stations within one of the 29 preselected New Zealand regions (note that stations can belong to more than one region). The <code>search = "region"</code> argument must be added to the <code>cf_find_station</code> function to conduct these searches. If the region is unknown then the search argument may be missing which brings up an interactive menu of the 29 regions for the user to select (<code>cf_find_station(search = "region")</code>), otherwise partial matching is used.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Partial match for the Queenstown region</span></span>
<span><span class="va">open.queenstown.stations</span> <span class="op">=</span> <span class="fu"><a href="../reference/cf_find_station.html">cf_find_station</a></span><span class="op">(</span><span class="st">"queen"</span>, search <span class="op">=</span> <span class="st">"region"</span><span class="op">)</span></span></code></pre></div>
<p>Typing <code>open.queenstown.stations</code> into R will then return all the 264 open Queenstown stations. This is clearly a burden to choose stations based on a large list of numbers hence plotting them on a map (covered below) to assess their spatial extent will make this task much easier.</p>
</div>
<div class="section level3">
<h3 id="return-all-stations-within-the-vicinity-of-a-given-location">Return all stations within the vicinity of a given location<a class="anchor" aria-label="anchor" href="#return-all-stations-within-the-vicinity-of-a-given-location"></a>
</h3>
<p>This location based search is conducted by including the <code>search = "latlong"</code> argument to the <code>cf_find_station</code> function. There are three parameters needed for this search; latitude, longitude and radius (kilometres). Just like any other function in R, if these arguments aren’t named then the order matters and should be written in the order specified above. The latitude and longitude must be given in decimal degrees.</p>
<p>We are (still) interested in finding all open stations around the small town of Takaka. From <a href="https://tools.wmflabs.org/geohack/geohack.php?pagename=Takaka%2C_New_Zealand&amp;params=40_51_S_172_48_E_type:city%281149%29_region:NZ" class="external-link">GeoHack</a> we can see that the latitude is -40.85 and the longitude is 172.8. We are interested in all open stations within a 10km radius of the main township.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">takaka.town.st</span> <span class="op">=</span> <span class="fu"><a href="../reference/cf_find_station.html">cf_find_station</a></span><span class="op">(</span>lat <span class="op">=</span> <span class="op">-</span><span class="fl">40.85</span>, long <span class="op">=</span> <span class="fl">172.8</span>, rad <span class="op">=</span> <span class="fl">10</span>, search <span class="op">=</span> <span class="st">"latlong"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print the result, but remove the lat and lon columns to fit the page</span></span>
<span><span class="va">takaka.town.st</span><span class="op">[</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">9</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##                         name network agent      start        end open distance</span></span>
<span><span class="co">## 1       Takaka, Kotinga Road  F02882  3788 1970-08-01 2020-08-31 TRUE      2.6</span></span>
<span><span class="co">## 2              Takaka Pohara  F02884  3790 1986-07-01 2020-08-31 TRUE      5.7</span></span>
<span><span class="co">## 3      Anatoki At Happy Sams  F15293 44015 1990-10-31 2020-08-31 TRUE      5.8</span></span>
<span><span class="co">## 4          Takaka At Kotinga  F15291 44051 1992-04-24 2020-08-31 TRUE      2.4</span></span>
<span><span class="co">## 5                 Takaka Ews  F02885 23849 2002-04-30 2020-08-31 TRUE      1.6</span></span>
<span><span class="co">## 6 Motupiko At Reillys Bridge  F1529M 44041 2006-11-29 2020-08-31 TRUE      2.7</span></span>
<span><span class="co">## 7           Takaka Aero Raws  O00957 41196 2015-08-12 2020-08-31 TRUE      4.3</span></span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># We may rather order the stations by distance from the township</span></span>
<span><span class="va">takaka.town.st</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">takaka.town.st</span><span class="op">$</span><span class="va">distance</span><span class="op">)</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">9</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##                         name network agent      start        end open distance</span></span>
<span><span class="co">## 5                 Takaka Ews  F02885 23849 2002-04-30 2020-08-31 TRUE      1.6</span></span>
<span><span class="co">## 4          Takaka At Kotinga  F15291 44051 1992-04-24 2020-08-31 TRUE      2.4</span></span>
<span><span class="co">## 1       Takaka, Kotinga Road  F02882  3788 1970-08-01 2020-08-31 TRUE      2.6</span></span>
<span><span class="co">## 6 Motupiko At Reillys Bridge  F1529M 44041 2006-11-29 2020-08-31 TRUE      2.7</span></span>
<span><span class="co">## 7           Takaka Aero Raws  O00957 41196 2015-08-12 2020-08-31 TRUE      4.3</span></span>
<span><span class="co">## 2              Takaka Pohara  F02884  3790 1986-07-01 2020-08-31 TRUE      5.7</span></span>
<span><span class="co">## 3      Anatoki At Happy Sams  F15293 44015 1990-10-31 2020-08-31 TRUE      5.8</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="searches-based-on-datatypes">Searches based on datatypes<a class="anchor" aria-label="anchor" href="#searches-based-on-datatypes"></a>
</h2>
<p>All the above searches did not include a datatype therefore they ignore the datatypes available at these stations. Imagine we are looking for hourly rain data at an open station in Takaka (using any of the aforementioned searches), we would need to include the hourly rain datatype in the search for it to return a suitable station.</p>
<div class="section level4">
<h4 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a>
</h4>
<p>Unless the Reefton EWS station is the only CliFlo station of interest, the user will need a <a href="https://cliflo.niwa.co.nz/pls/niwp/wsubform.intro" class="external-link">CliFlo account</a> to get data from other stations.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a clifro datatype for hourly rain</span></span>
<span><span class="va">hourly.rain.dt</span> <span class="op">=</span> <span class="fu"><a href="../reference/cfDatatype-class.html">cf_datatype</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">hourly.rain.dt</span></span></code></pre></div>
<pre><code><span><span class="co">##           dt.name              dt.type dt.options dt.combo</span></span>
<span><span class="co">## dt1 Precipitation Rain (fixed periods)   [Hourly]</span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Conduct the search</span></span>
<span><span class="fu"><a href="../reference/cf_find_station.html">cf_find_station</a></span><span class="op">(</span><span class="st">"takaka"</span>, datatype <span class="op">=</span> <span class="va">hourly.rain.dt</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##          name network agent      start        end open distance</span></span>
<span><span class="co">## 1) Takaka Ews  F02885 23849 2002-06-02 2020-08-16 TRUE       NA</span></span></code></pre>
<p>This tells us that the only <em>open</em> station in Takaka where hourly rain data is available is at the Takaka Ews station.</p>
</div>
</div>
<div class="section level2">
<h2 id="more-than-one-search-at-a-time">More than one search at a time<a class="anchor" aria-label="anchor" href="#more-than-one-search-at-a-time"></a>
</h2>
<p>Since the <code>cf_find_station</code> function returns <code>cfStation</code> objects, any of these methods work on objects created from the <code>cf_station</code> function (see the <a href="cfStation.html">working with clifro stations vignette</a> for more details). We can conduct two or more searches at a time using the addition sign, just like we did for <code>cfDatatype</code>s (see the <a href="choose-datatype.html">choose datatypes vignette</a>).</p>
<p>We would like to return all open stations within a 10km radius of the Takaka township in the South Island, and the open stations in Kaitaia, in the North Island that collect hourly rain data.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my.composite.search</span> <span class="op">=</span> <span class="va">takaka.town.st</span> <span class="op">+</span> <span class="fu"><a href="../reference/cf_find_station.html">cf_find_station</a></span><span class="op">(</span><span class="st">"kaitaia"</span>, </span>
<span>                                                       search <span class="op">=</span> <span class="st">"region"</span>, </span>
<span>                                                       datatype <span class="op">=</span> <span class="va">hourly.rain.dt</span><span class="op">)</span></span>
<span><span class="va">my.composite.search</span></span></code></pre></div>
<pre><code><span><span class="co">##                           name network agent      start        end open</span></span>
<span><span class="co">## 1)        Takaka, Kotinga Road  F02882  3788 1970-08-01 2020-08-31 TRUE</span></span>
<span><span class="co">## 2)               Takaka Pohara  F02884  3790 1986-07-01 2020-08-31 TRUE</span></span>
<span><span class="co">## 3)       Anatoki At Happy Sams  F15293 44015 1990-10-31 2020-08-31 TRUE</span></span>
<span><span class="co">## 4)           Takaka At Kotinga  F15291 44051 1992-04-24 2020-08-31 TRUE</span></span>
<span><span class="co">## 5)                  Takaka Ews  F02885 23849 2002-04-30 2020-08-31 TRUE</span></span>
<span><span class="co">## 6)  Motupiko At Reillys Bridge  F1529M 44041 2006-11-29 2020-08-31 TRUE</span></span>
<span><span class="co">## 7)            Takaka Aero Raws  O00957 41196 2015-08-12 2020-08-31 TRUE</span></span>
<span><span class="co">## 8)            Kaitaia Aero Ews  A53026 18183 2000-06-15 2020-08-30 TRUE</span></span>
<span><span class="co">## 9)                Trounson Cws  A53762 37131 2009-06-04 2020-08-30 TRUE</span></span>
<span><span class="co">## 10)                Russell Cws  A54212 41262 2016-04-05 2020-08-30 TRUE</span></span>
<span><span class="co">## 11)                Kaikohe Aws  A53487  1134 1985-11-14 2020-08-29 TRUE</span></span>
<span><span class="co">## 12)                Purerua Aws  A54101  1196 1995-01-01 2020-08-29 TRUE</span></span>
<span><span class="co">## 13)            Cape Reinga Aws  A42462  1002 1995-01-01 2020-08-29 TRUE</span></span>
<span><span class="co">## 14)     Kerikeri Aerodrome Aws  A53295 37258 2008-06-26 2020-08-29 TRUE</span></span>
<span><span class="co">## 15)                Kaitaia Ews  A53127 17067 1998-12-17 2020-08-27 TRUE</span></span>
<span><span class="co">## 16)           Dargaville 2 Ews  A53987 25119 2003-10-30 2020-08-22 TRUE</span></span>
<span><span class="co">## 17)               Kerikeri Ews  A53191  1056 2002-06-28 2020-08-21 TRUE</span></span>
<span><span class="co">##     distance       lat      lon</span></span>
<span><span class="co">## 1)       2.6 -40.87200 172.8090</span></span>
<span><span class="co">## 2)       5.7 -40.84500 172.8670</span></span>
<span><span class="co">## 3)       5.8 -40.88587 172.7498</span></span>
<span><span class="co">## 4)       2.4 -40.87068 172.8080</span></span>
<span><span class="co">## 5)       1.6 -40.86364 172.8057</span></span>
<span><span class="co">## 6)       2.7 -40.85607 172.8316</span></span>
<span><span class="co">## 7)       4.3 -40.81531 172.7765</span></span>
<span><span class="co">## 8)        NA -35.06770 173.2874</span></span>
<span><span class="co">## 9)        NA -35.72035 173.6515</span></span>
<span><span class="co">## 10)       NA -35.26835 174.1360</span></span>
<span><span class="co">## 11)       NA -35.41720 173.8229</span></span>
<span><span class="co">## 12)       NA -35.12900 174.0150</span></span>
<span><span class="co">## 13)       NA -34.42963 172.6819</span></span>
<span><span class="co">## 14)       NA -35.26200 173.9110</span></span>
<span><span class="co">## 15)       NA -35.13352 173.2629</span></span>
<span><span class="co">## 16)       NA -35.93145 173.8532</span></span>
<span><span class="co">## 17)       NA -35.18300 173.9260</span></span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># How long have these stations been open for?</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span><span class="va">my.composite.search</span>, ndays <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">end</span> <span class="op">-</span> <span class="va">start</span><span class="op">)</span><span class="op">)</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##                          name      ndays</span></span>
<span><span class="co">## 1        Takaka, Kotinga Road 18293 days</span></span>
<span><span class="co">## 2               Takaka Pohara 12480 days</span></span>
<span><span class="co">## 3       Anatoki At Happy Sams 10897 days</span></span>
<span><span class="co">## 4           Takaka At Kotinga 10356 days</span></span>
<span><span class="co">## 5                  Takaka Ews  6698 days</span></span>
<span><span class="co">## 6  Motupiko At Reillys Bridge  5024 days</span></span>
<span><span class="co">## 7            Takaka Aero Raws  1846 days</span></span>
<span><span class="co">## 8            Kaitaia Aero Ews  7381 days</span></span>
<span><span class="co">## 9                Trounson Cws  4105 days</span></span>
<span><span class="co">## 10                Russell Cws  1608 days</span></span>
<span><span class="co">## 11                Kaikohe Aws 12707 days</span></span>
<span><span class="co">## 12                Purerua Aws  9372 days</span></span>
<span><span class="co">## 13            Cape Reinga Aws  9372 days</span></span>
<span><span class="co">## 14     Kerikeri Aerodrome Aws  4447 days</span></span>
<span><span class="co">## 15                Kaitaia Ews  7924 days</span></span>
<span><span class="co">## 16           Dargaville 2 Ews  6141 days</span></span>
<span><span class="co">## 17               Kerikeri Ews  6629 days</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="so-where-are-these-stations">So where are these stations?<a class="anchor" aria-label="anchor" href="#so-where-are-these-stations"></a>
</h2>
<p>Up until now there probably hasn’t been any good reason to choose clifro to search for stations instead of the <a href="https://cliflo.niwa.co.nz/pls/niwp/wstn.get_stn_html" class="external-link">‘Choose Stations’ form on CliFlo</a>. However, the real advantage of using clifro is to visualise the station locations on a map by returning a KML file, particularly when there are lots of stations returned by the search. This Keyhole Markup Language (<a href="https://resources.arcgis.com/en/help/main/10.1/index.html#//00s20000000m000000" class="external-link">KML</a>) is an XML-based language provided by Google(TM) for defining the graphic display of spatial data in applications such as Google Earth(TM) and Google Maps(TM).</p>
<p>To return the stations as a KML file simply use the <code>cf_save_kml</code> function on any <code>cfStation</code> object. The <code>cf_find_station</code> function returns <code>cfStation</code> objects therefore it’s very easy to plot these on a map. To assess the geographic extent of the Auckland stations we can return a KML file from the search and open it using our preferred KML-friendly software.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># First, search for the stations</span></span>
<span><span class="va">all.auckland.st</span> <span class="op">=</span> <span class="fu"><a href="../reference/cf_find_station.html">cf_find_station</a></span><span class="op">(</span><span class="st">"auckland"</span>, search <span class="op">=</span> <span class="st">"region"</span>, status <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span></span></code></pre></div>
<p>Now <code>all.auckland.st</code> contains the hundreds of Auckland stations where data have been recorded on CliFlo.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Then save these as a KML</span></span>
<span><span class="fu"><a href="../reference/cf_save_kml.html">cf_save_kml</a></span><span class="op">(</span><span class="va">all.auckland.st</span>, file_name <span class="op">=</span> <span class="st">"all_auckland_stations"</span><span class="op">)</span></span></code></pre></div>
<p>The green markers represent the open stations and the red markers indicate closed stations. The resulting KML file is saved to the current R session’s working directory by default. Have a look at the <a href="cfStation.html">clifro station vignette</a> for more methods and plotting of <code>cfStation</code> objects.</p>
<div class="figure">
<img src="figures/map.png" alt=""><p class="caption">All Auckland Stations</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg">
</div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul>
</div>
                    <div class="col-md-3 col-sm-4">
                        <ul>
<h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul>
</div>
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul>
</div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer>
</div>

  

  

  </body>
</html>
